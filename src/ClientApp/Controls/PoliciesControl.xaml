<UserControl x:Class="KC.ITCompanion.ClientApp.Controls.PoliciesControl"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             xmlns:vm="clr-namespace:KC.ITCompanion.ClientApp.ViewModels"
             mc:Ignorable="d">
    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>
        <DockPanel Grid.Row="0" Margin="8">
            <ItemsControl ItemsSource="{Binding CategoryLevels}" DockPanel.Dock="Left">
                <ItemsControl.ItemsPanel>
                    <ItemsPanelTemplate>
                        <StackPanel Orientation="Horizontal"/>
                    </ItemsPanelTemplate>
                </ItemsControl.ItemsPanel>
                <ItemsControl.ItemTemplate>
                    <DataTemplate DataType="{x:Type vm:CategoryNavLevel}">
                        <ComboBox Width="160" Margin="0,0,8,0" ItemsSource="{Binding Options}" SelectedItem="{Binding Selected, Mode=TwoWay}" DisplayMemberPath="Name" />
                    </DataTemplate>
                </ItemsControl.ItemTemplate>
            </ItemsControl>
            <TextBlock Text="{Binding Breadcrumb}" VerticalAlignment="Center" Style="{StaticResource Control.Text.Caption}"/>
        </DockPanel>
        <DataGrid Grid.Row="1" Margin="8" ItemsSource="{Binding CategoryPolicyRows}" AutoGenerateColumns="False" CanUserSortColumns="True" AlternationCount="2" IsReadOnly="True" Style="{StaticResource Control.DataGrid.Base}" MouseDoubleClick="OnPolicyGridDoubleClick">
            <DataGrid.ContextMenu>
                <ContextMenu>
                    <MenuItem Header="Columns">
                        <MenuItem Header="Name" IsCheckable="True" IsChecked="{Binding DataContext.ColumnVisibility.Name, RelativeSource={RelativeSource AncestorType=UserControl}}" />
                        <MenuItem Header="Key" IsCheckable="True" IsChecked="{Binding DataContext.ColumnVisibility.Key, RelativeSource={RelativeSource AncestorType=UserControl}}" />
                        <MenuItem Header="Scope" IsCheckable="True" IsChecked="{Binding DataContext.ColumnVisibility.Scope, RelativeSource={RelativeSource AncestorType=UserControl}}" />
                        <MenuItem Header="Category" IsCheckable="True" IsChecked="{Binding DataContext.ColumnVisibility.Category, RelativeSource={RelativeSource AncestorType=UserControl}}" />
                        <MenuItem Header="Supported On" IsCheckable="True" IsChecked="{Binding DataContext.ColumnVisibility.SupportedOn, RelativeSource={RelativeSource AncestorType=UserControl}}" />
                        <MenuItem Header="Description" IsCheckable="True" IsChecked="{Binding DataContext.ColumnVisibility.Description, RelativeSource={RelativeSource AncestorType=UserControl}}" />
                    </MenuItem>
                </ContextMenu>
            </DataGrid.ContextMenu>
            <DataGrid.Columns>
                <DataGridTextColumn Header="Name" Binding="{Binding Name}" Width="2*" Visibility="{Binding DataContext.ColumnVisibility.Name, RelativeSource={RelativeSource AncestorType=UserControl}, Converter={StaticResource BooleanToVisibilityConverter}}"/>
                <DataGridTextColumn Header="Key" Binding="{Binding Key}" Width="*" Visibility="{Binding DataContext.ColumnVisibility.Key, RelativeSource={RelativeSource AncestorType=UserControl}, Converter={StaticResource BooleanToVisibilityConverter}}"/>
                <DataGridTextColumn Header="Scope" Binding="{Binding Scope}" Width="*" Visibility="{Binding DataContext.ColumnVisibility.Scope, RelativeSource={RelativeSource AncestorType=UserControl}, Converter={StaticResource BooleanToVisibilityConverter}}"/>
                <DataGridTextColumn Header="Category" Binding="{Binding CategoryPath}" Width="2*" Visibility="{Binding DataContext.ColumnVisibility.Category, RelativeSource={RelativeSource AncestorType=UserControl}, Converter={StaticResource BooleanToVisibilityConverter}}"/>
                <DataGridTextColumn Header="Supported On" Binding="{Binding SupportedOn}" Width="*" Visibility="{Binding DataContext.ColumnVisibility.SupportedOn, RelativeSource={RelativeSource AncestorType=UserControl}, Converter={StaticResource BooleanToVisibilityConverter}}"/>
                <DataGridTextColumn Header="Description" Binding="{Binding Description}" Width="3*" Visibility="{Binding DataContext.ColumnVisibility.Description, RelativeSource={RelativeSource AncestorType=UserControl}, Converter={StaticResource BooleanToVisibilityConverter}}"/>
            </DataGrid.Columns>
        </DataGrid>
        <Border Grid.Row="2" BorderThickness="1" BorderBrush="{DynamicResource Brush.Border}" Margin="8" Padding="8">
            <StackPanel>
                <TextBlock Text="Policy Settings" Style="{StaticResource Control.Text.Subtitle}" Margin="0,0,0,4"/>
                <ItemsControl ItemsSource="{Binding SelectedPolicySettings}">
                    <ItemsControl.ItemTemplate>
                        <DataTemplate DataType="{x:Type vm:PolicySettingViewModel}">
                            <StackPanel Margin="0,0,0,6">
                                <TextBlock Text="{Binding PartId}" FontWeight="Bold"/>
                                <TextBlock Text="{Binding ValueType}" FontStyle="Italic"/>
                            </StackPanel>
                        </DataTemplate>
                    </ItemsControl.ItemTemplate>
                </ItemsControl>
            </StackPanel>
        </Border>
    </Grid>
</UserControl>